"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[922],{54399:(e,t,s)=>{s.d(t,{A:()=>N});var a=s(95155),r=s(12115),n=s(26265),l=s(80019),i=s(68425),o=s(47734),d=s(73697),c=s(33420),m=s(78067),u=s(67485),h=s(13044),g=s(37665),p=s(83457),x=s(1524),f=s(23327),v=s(26983),b=s(19503);function y(e,t){let s=Date.now()-60*t*6e4;return e.filter(e=>e.timestamp>=s)}function j(e){let t;if(0===e.length)return{avgValence:0,avgArousal:.5,dominantQuadrant:1};let s=e.reduce((e,t)=>e+t.valence,0),a=e.reduce((e,t)=>e+t.arousal,0),r=s/e.length,n=a/e.length;return t=r>0&&n>.5?1:r<0&&n>.5?2:r<0&&n<=.5?3:4,{avgValence:r,avgArousal:n,dominantQuadrant:t}}function N(e){let{compact:t=!1}=e,[s,N]=(0,r.useState)([]),[k,w]=(0,r.useState)([]),[S,D]=(0,r.useState)(7),[T,A]=(0,r.useState)(!1),[q,W]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=function(){let e=[];try{let t=localStorage.getItem("navlosen-emotions");if(!t)return[];let s=JSON.parse(t),a=localStorage.getItem("navlosen-affect-signals"),r=a?JSON.parse(a):[],n=localStorage.getItem("navlosen-mock-hrv-data"),l=n?JSON.parse(n):[];s.forEach((t,a)=>{let n=t.timestamp||Date.now()-(s.length-a)*36e5,i=t.quadrant,o=(0,b.JA)(i),d=(0,b.yY)(i),c=(0,b.r$)(d),m=l.find(e=>3e5>Math.abs(e.timestamp-n)),u=r.find(e=>3e5>Math.abs(e.timestamp-n));e.push({timestamp:n,valence:o,arousal:c,emotionWord:t.word,quadrant:i,hrvRmssd:null==m?void 0:m.rmssd,eventTag:null==u?void 0:u.eventTag,stressLevel:null==u?void 0:u.stressLevel})}),e.sort((e,t)=>e.timestamp-t.timestamp)}catch(e){console.error("[AffectTimeline] Failed to process emotion history:",e)}return e}();N(e),w(function(e){let t=[];if(e.length<3)return t;let s=null,a=0;e.forEach((r,n)=>{if(r.arousal<.4&&r.valence<.2)null===s&&(s=r.timestamp),a++;else{if(a>=3&&null!==s){let r=e[n-1];t.push({type:"low-energy-sustained",startTime:s,endTime:r.timestamp,description:"Lav energi og motivasjon i ".concat(a," m\xe5linger over ").concat(Math.ceil((r.timestamp-s)/864e5)," dager."),severity:a>7?"high":a>5?"medium":"low"})}s=null,a=0}});let r=null,n=0;return e.forEach((s,a)=>{if(s.arousal>.7&&s.valence<0)null===r&&(r=s.timestamp),n++;else{if(n>=3&&null!==r){let s=e[a-1];t.push({type:"high-stress-sustained",startTime:r,endTime:s.timestamp,description:"H\xf8yt stressniv\xe5 i ".concat(n," m\xe5linger over ").concat(Math.ceil((s.timestamp-r)/864e5)," dager."),severity:n>7?"high":n>5?"medium":"low"})}r=null,n=0}}),e.forEach(e=>{e.valence>.6&&e.arousal>.7&&t.push({type:"positive-peak",startTime:e.timestamp,endTime:e.timestamp,description:'H\xf8y energi og positivitet: "'.concat(e.emotionWord,'"'),severity:"low"})}),e.forEach(e=>{e.valence<-.5&&e.arousal<.3&&t.push({type:"negative-valley",startTime:e.timestamp,endTime:e.timestamp,description:'Lav energi og negativitet: "'.concat(e.emotionWord,'"'),severity:e.stressLevel&&e.stressLevel>7?"high":"medium"})}),t}(e)),W(function(e){let t=[];if(e.length<7)return["Fortsett \xe5 registrere dine f\xf8lelser for \xe5 se m\xf8nstre over tid."];let s=e.filter(e=>{let t=new Date(e.timestamp).getHours();return t>=6&&t<12}),a=e.filter(e=>{let t=new Date(e.timestamp).getHours();return t>=12&&t<18}),r=e.filter(e=>{let t=new Date(e.timestamp).getHours();return t>=18||t<6}),n=j(s),l=j(a),i=j(r),o=[{time:"formiddagene",arousal:n.avgArousal,count:s.length},{time:"ettermiddagene",arousal:l.avgArousal,count:a.length},{time:"kveldene",arousal:i.avgArousal,count:r.length}].filter(e=>e.count>0);if(o.length>0){let e=o.reduce((e,t)=>t.arousal>e.arousal?t:e);t.push("Du har mest energi p\xe5 ".concat(e.time,"."))}let d={};e.forEach(e=>{d[e.emotionWord]=(d[e.emotionWord]||0)+1});let c=Object.entries(d).sort((e,t)=>{let[,s]=e,[,a]=t;return a-s})[0];c&&t.push('Din mest registrerte f\xf8lelse er "'.concat(c[0],'" (').concat(c[1]," ganger)."));let m=j(y(e,168));return m.avgValence>.3?t.push("Du har hatt en positiv uke."):m.avgValence<-.3?t.push("Du har hatt en utfordrende uke. Husk at det er lov \xe5 s\xf8ke st\xf8tte."):t.push("Du har hatt en balansert uke med b\xe5de oppturer og nedturer."),t}(e))},[]);let L=0===S?s:y(s,24*S),M=L.map(e=>({timestamp:e.timestamp,date:new Date(e.timestamp).toLocaleDateString("nb-NO",{month:"short",day:"numeric"}),valence:e.valence,emotionWord:e.emotionWord})),C=L.map(e=>({valence:e.valence,arousal:e.arousal,emotionWord:e.emotionWord,quadrant:e.quadrant,timestamp:e.timestamp})),E=e=>({1:"#10b981",2:"#f97316",3:"#ef4444",4:"#3b82f6"})[e];return 0===s.length?(0,a.jsxs)("div",{className:"p-6 bg-gray-50 rounded-lg text-center",children:[(0,a.jsx)(p.A,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Ingen emosjonelle data enn\xe5."}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Start med Mestring for \xe5 registrere dine f\xf8lelser."})]}):t?(0,a.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,a.jsxs)("h3",{className:"font-semibold text-gray-800 flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"w-5 h-5 text-purple-500"}),"Din f\xf8lelsesreise (siste 7 dager)"]})}),(0,a.jsx)(n.u,{width:"100%",height:150,children:(0,a.jsxs)(l.b,{data:M.slice(-7),children:[(0,a.jsx)(i.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,a.jsx)(o.W,{dataKey:"date",tick:{fontSize:10}}),(0,a.jsx)(d.h,{domain:[-1,1],tick:{fontSize:10}}),(0,a.jsx)(c.m,{content:e=>{let{payload:t}=e;if(t&&t.length>0){let e=t[0].payload;return(0,a.jsxs)("div",{className:"bg-white p-2 border border-gray-200 rounded shadow-sm text-xs",children:[(0,a.jsx)("p",{className:"font-semibold",children:e.emotionWord}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Valens: ",e.valence.toFixed(2)]})]})}return null}}),(0,a.jsx)(m.N,{type:"monotone",dataKey:"valence",stroke:"#8b5cf6",strokeWidth:2,dot:{fill:"#8b5cf6",r:3}})]})}),(0,a.jsx)("div",{className:"mt-2 text-center",children:(0,a.jsx)("a",{href:"/min-reise",className:"text-sm text-purple-600 hover:underline",children:"Se hele historikken →"})})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"w-7 h-7 text-purple-500"}),"Din F\xf8lelsesreise"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>D(7),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(7===S?"bg-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"7 dager"}),(0,a.jsx)("button",{onClick:()=>D(30),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(30===S?"bg-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"30 dager"}),(0,a.jsx)("button",{onClick:()=>D(0),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(0===S?"bg-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"Alle"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800 mb-4",children:"Emosjonell Valens Over Tid"}),(0,a.jsx)(n.u,{width:"100%",height:300,children:(0,a.jsxs)(l.b,{data:M,children:[(0,a.jsx)(i.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,a.jsx)(o.W,{dataKey:"date"}),(0,a.jsx)(d.h,{domain:[-1,1],label:{value:"Valens",angle:-90,position:"insideLeft"}}),(0,a.jsx)(c.m,{content:e=>{let{payload:t}=e;if(t&&t.length>0){let e=t[0].payload;return(0,a.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded shadow-lg",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-800",children:e.emotionWord}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Valens: ",e.valence.toFixed(2)]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.date})]})}return null}}),(0,a.jsx)(m.N,{type:"monotone",dataKey:"valence",stroke:"#8b5cf6",strokeWidth:3,dot:{fill:"#8b5cf6",r:4}})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800 mb-4",children:"Circumplex-Kart (Arousal \xd7 Valens)"}),(0,a.jsx)(n.u,{width:"100%",height:400,children:(0,a.jsxs)(u.t,{children:[(0,a.jsx)(i.d,{strokeDasharray:"3 3"}),(0,a.jsx)(o.W,{type:"number",dataKey:"valence",domain:[-1,1],label:{value:"Valens",position:"insideBottom",offset:-5}}),(0,a.jsx)(d.h,{type:"number",dataKey:"arousal",domain:[0,1],label:{value:"Arousal",angle:-90,position:"insideLeft"}}),(0,a.jsx)(c.m,{content:e=>{let{payload:t}=e;if(t&&t.length>0){let e=t[0].payload;return(0,a.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded shadow-lg",children:[(0,a.jsx)("p",{className:"font-semibold",style:{color:E(e.quadrant)},children:e.emotionWord}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:["Valens: ",e.valence.toFixed(2)]}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:["Arousal: ",e.arousal.toFixed(2)]})]})}return null}}),[1,2,3,4].map(e=>(0,a.jsx)(h.X,{data:C.filter(t=>t.quadrant===e),fill:E(e),name:"Q".concat(e)},e)),(0,a.jsx)(g.s,{})]})})]}),(0,a.jsxs)("div",{className:"bg-purple-50 rounded-lg p-6",children:[(0,a.jsxs)("button",{onClick:()=>A(!T),className:"flex items-center gap-2 font-semibold text-purple-800 mb-3",children:[(0,a.jsx)(f.A,{className:"w-5 h-5"}),(0,a.jsxs)("span",{children:["Auto-Innsikter ",T?"▼":"►"]})]}),T&&(0,a.jsx)("div",{className:"space-y-2",children:q.map((e,t)=>(0,a.jsxs)("p",{className:"text-sm text-purple-900",children:["• ",e]},t))})]}),k.length>0&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"w-5 h-5 text-gray-600"}),"M\xf8nstre Detektert"]}),(0,a.jsx)("div",{className:"space-y-3",children:k.map((e,t)=>(0,a.jsxs)("div",{className:"p-3 rounded-lg border-l-4 ".concat("high"===e.severity?"border-red-500 bg-red-50":"medium"===e.severity?"border-orange-500 bg-orange-50":"border-green-500 bg-green-50"),children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-800",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Type: ",e.type," | Periode: ",new Date(e.startTime).toLocaleDateString("nb-NO"),e.endTime!==e.startTime&&" - ".concat(new Date(e.endTime).toLocaleDateString("nb-NO"))]})]},t))})]})]})}},69023:(e,t,s)=>{function a(e){let t,s=e.stressSlider,a=function(e){if(0===e.length)return 5;e.filter(e=>3===e.quadrant||4===e.quadrant).length,e.filter(e=>1===e.quadrant||2===e.quadrant).length;let t=e.filter(e=>4===e.quadrant).length;return Math.max(1,Math.min(10,1+9*((1.2*t+ +e.filter(e=>3===e.quadrant).length)/(e.length||1))))}(e.selectedEmotions),r=function(e){let t=e.filter(e=>e.checked).length;return Math.max(1,Math.min(10,1+t/(e.length||6)*9))}(e.somaticSignals),n=function(e){if(0===e.length)return 5;let t=0,s=e.length;return e.forEach(e=>{let s=e.answer.toLowerCase();"safety"===e.questionId&&(s.includes("utrygg")||s.includes("nei"))&&(t+=2),"support"===e.questionId&&(s.includes("ja")||s.includes("snakke"))&&(t+=1.5),("sleep"===e.questionId||"sleep-quality"===e.questionId)&&(s.includes("d\xe5rlig")||s.includes("under 4"))&&(t+=1),"trigger"===e.questionId&&e.answer.length>10&&(t+=.5)}),Math.max(1,Math.min(10,1+t/s*4.5))}(e.liraAnswers),l=.4*s,i=.3*a,o=.2*r,d=.1*n,c=Math.max(1,Math.min(10,Math.round(10*(l+i+o+d))/10));return{compositeScore:c,polyvagalState:c<=3?"ventral":c<=7?"sympathetic":"dorsal",breakdown:{sliderContribution:l,emotionContribution:i,somaticContribution:o,liraContribution:d},confidence:(t=0,e.stressSlider>0&&(t+=1),e.selectedEmotions.length>0&&(t+=1),e.somaticSignals.some(e=>e.checked)&&(t+=1),e.liraAnswers.length>0&&(t+=1),t/4)}}function r(e){switch(e){case"ventral":return{touchTargetSize:44,maxChoices:"unlimited",taskDuration:null,prominentButtons:[],cognitiveTasks:"full",microcopy:"collaborative",backgroundColor:"bg-green-50",stateLabel:"Rolig"};case"sympathetic":return{touchTargetSize:56,maxChoices:3,taskDuration:90,prominentButtons:["Pause","Ett steg av gangen"],cognitiveTasks:"simplified",microcopy:"supportive",backgroundColor:"bg-orange-50",stateLabel:"Aktivert"};case"dorsal":return{touchTargetSize:72,maxChoices:2,taskDuration:null,prominentButtons:["Ring Veileder","Trygg Havn"],cognitiveTasks:"blocked",microcopy:"shame-free",backgroundColor:"bg-blue-50",stateLabel:"Overveldet"}}}s.d(t,{F:()=>r,Y:()=>a})}}]);